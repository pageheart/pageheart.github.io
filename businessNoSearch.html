<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript">
    // POST 메서드 구현 예제
    async function ajaxCall(url = '', data = {}) {
      // 옵션 기본 값은 *로 강조
      const response = await fetch(url, {
        method: 'POST', // *GET, POST, PUT, DELETE 등
        mode: 'cors', // no-cors, *cors, same-origin
        cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
        credentials: 'same-origin', // include, *same-origin, omit
        headers: {
          'Content-Type': 'application/json',
          // 'Content-Type': 'application/x-www-form-urlencoded',
        },
        redirect: 'follow', // manual, *follow, error
        referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
        body: JSON.stringify(data), // body의 데이터 유형은 반드시 "Content-Type" 헤더와 일치해야 함
      });
      return response.json(); // JSON 응답을 네이티브 JavaScript 객체로 파싱
    }

    var statusSearch = {
      searchData : ()=>{
        return document.getElementById("BusinessNoTextarea").value.replace(/-/g,'').split("\n");
      },
      ajaxCall : ()=>{
        let searchData = statusSearch.searchData();
        if(searchData.length > 0) {
          if(searchData.length > 100) {
            alert("한번에 최대 100개까지만 조회 가능 합니다.");
          }
          else {
            ajaxCall('https://api.odcloud.kr/api/nts-businessman/v1/status?serviceKey=3hRZAJC%2FG0MrVFquB7UvOGOhlw1%2FRSctGxSnFV5rs39ahaQJzfKMcEinWFv2%2Fke5zQD%2B2lH5jm3eiF51EkHCEQ%3D%3D'
                , {
                'b_no': searchData
              }).then((res) => { // JSON 데이터가 `data.json()` 호출에 의해 파싱됨
                if(res.status_code === 'OK') {
                    console.log(res);
                    res.data.forEach(d=>{
                        statusSearch.divTagAdd(d.b_no);
                        statusSearch.divTagAdd(d.tax_type);
                        statusSearch.divTagAdd(new Date().toLocaleDateString("ko-kr"));
                    });
                }
            });
          }
        }
        else {
          alert("사업자등록번호를 입력 해 주세요.");
        }
      },
      divTagAdd : (txt)=>{
        let divTag = document.createElement("div");
        divTag.className = "item";
        divTag.append(document.createTextNode(txt));
        document.querySelector(".container").append(divTag);
      }
    }
    </script>
    <style>
      .container {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
      }
      a {
        text-decoration: none;
      }
      .transitionArea .btn_hover.red {
        background:#ff2e62;
      }
      .transitionArea .btn_hover span {
        position: relative;
        top:0;
        transition: top .15s ease;
      }
      .transitionArea .btn_hover span:nth-of-type(2) {
        transition-delay: .05s;
      }
      .transitionArea .btn_hover span:nth-of-type(3) {
        transition-delay: .10s;
      }
      .transitionArea .btn_hover span:nth-of-type(4) {
        transition-delay: .15s;
      }
      .transitionArea .btn_hover span:nth-of-type(5) {
        transition-delay: .20s;
      }
      .transitionArea .btn_hover span:nth-of-type(6) {
        transition-delay: .25s;
      }
      .transitionArea .btn_hover {
        display: flex;
        align-items: center;
        width: 115px;
        height: 40px;
        padding-left: 19px;
        color: #fff;
        font-size: 13px;
        font-weight: bold;
        box-sizing: border-box;
        border-radius: 25px;
      }
    </style>
  </head>
  <body>
    <div>
      <div style="float:left; margin-right:20px;">
        사업자등록번호 : 
        <textarea id="BusinessNoTextarea"></textarea>
      </div>
      <div class="transitionArea">
          <a href="javascript:statusSearch.ajaxCall()" class="btn_hover red">
          <span>S</span>
          <span>E</span>
          <span>A</span>
          <span>R</span>
          <span>C</span>
          <span>H</span>
          </a>
      </div>
      <div>
        <h3>사업자등록상태조회</h3>
        <div class="container">
          <div class="item">사업자등록번호</div>
          <div class="item">사업자등록상태</div>
          <div class="item">조회기준일자</div>
          <div class="item">1</div>
          <div class="item">2</div>
          <div class="item">3</div>
          <div class="item">1</div>
          <div class="item">2</div>
          <div class="item">3</div>
        </div>
      </div>
    </div>
  </body>
</html>
